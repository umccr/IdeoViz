---
title: "IdeoViz"
author: "Ayesha"
date: "16 November 2018"
output: 
  html_document:
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r, message=FALSE}
require(IdeoViz)
require(RColorBrewer)
require(tidyr) #tidyr package, had to go back to terminal to install lol
require(dplyr)
```

```{r plot1}
data(binned_multiSeries)
ideo <- getIdeo("hg38")
head(ideo)
plotOnIdeo(chrom=seqlevels(binned_multiSeries), # which chrom to plot?
           ideoTable=ideo, # ideogram name
           values_GR=binned_multiSeries, # data goes here
           value_cols=1, # col to plot
           col=brewer.pal(n=5, 'Spectral'), # colours
           # val_range=c(0,3),
           plotType = 'rect', # set y-axis range
           ylab="array intensities",
           plot_title="Trendline example")

plotOnIdeo(chrom=seqlevels(binned_multiSeries), # which chrom to plot?
           ideoTable=ideo, # ideogram name
           values_GR=binned_multiSeries, # data goes here
           value_cols=2, # col to plot
           col=brewer.pal(n=5, 'Spectral'), # colours
           # val_range=c(0,3),
           plotType = 'rect', # set y-axis range
           ylab="array intensities",
           plot_title="Trendline example")

# binned_multiSeries$group1 <- 2
# binned_multiSeries$group2 <- rep(3, 461)

```





```{r}
#step 1 is reading in the data from github
testdata <- read.table("data/hg38_igv_manual_by_side.bed", col.names = c("Chromosome_and_strand", "start", "end"), stringsAsFactors = FALSE) 

#step 2: filtering out the data with values greater than 0 to plot
testdata = filter(testdata, start >0, end>0) 
# testdata <- filter(testdata, chromosome %in% paste0("chr", 1:3))

#separating the chromosome and strands into different columns
testdata = separate(testdata, 1, into = c("chromosome", "strand"), sep="_", remove = TRUE) #using tidyverse's function 

#replacing the r with "-"s for use as strand data
testdata$strand <- sub("r", "-", testdata$strand) 
testdata
testdata$strand <- sub("f", "+", testdata$strand)
testdata 

#retrieving required parameters for IRanges and GRanges objects
seq_names = c(testdata$chromosome)
strand = c(testdata$strand)
start = c(testdata$start)
end = c(testdata$end)

#creating IRanges objectn named ranges
ranges = IRanges(start = start, end = end)
ranges

#creating GRanges object named testRanges
testRanges = GRanges(seqnames = seq_names, ranges = ranges, strand = strand)
testRanges

#setting the metadata group column to an arbitrary number to plot
testRanges$group = 2

#subsetting the testRanges object into 3 chromosomes to prevent overload on the plotting function
fiveRanges = testRanges[1:5]
fiveRanges

#plotting
dev.off()
plotOnIdeo(chrom=seqlevels(fiveRanges), # which chrom to plot?
             ideoTable=ideo, # ideogram name
             values_GR=fiveRanges, # data goes here
             value_cols=1,
             val_range = c(0,2),# col to plot
             col=brewer.pal(n=5, 'Spectral'), # colours
             plotType = 'rect', # set y-axis range
             ylab="array intensities",
             plot_title="test example")


``` 
