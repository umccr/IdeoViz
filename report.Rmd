---
title: "IdeoViz"
author: "Ayesha"
date: "16 November 2018"
output: 
  html_document:
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r, message=FALSE}
require(IdeoViz)
require(RColorBrewer)
require(tidyr) #tidyr package, had to go back to terminal to install lol
```

```{r plot1}
data(binned_multiSeries)
ideo <- getIdeo("hg18")
head(ideo)
plotOnIdeo(chrom=seqlevels(binned_multiSeries), # which chrom to plot?
           ideoTable=ideo, # ideogram name
           values_GR=binned_multiSeries, # data goes here
           value_cols=1, # col to plot
           col=brewer.pal(n=5, 'Spectral'), # colours
           # val_range=c(0,3),
           plotType = 'rect', # set y-axis range
           ylab="array intensities",
           plot_title="Trendline example")

plotOnIdeo(chrom=seqlevels(binned_multiSeries), # which chrom to plot?
           ideoTable=ideo, # ideogram name
           values_GR=binned_multiSeries, # data goes here
           value_cols=2, # col to plot
           col=brewer.pal(n=5, 'Spectral'), # colours
           # val_range=c(0,3),
           plotType = 'rect', # set y-axis range
           ylab="array intensities",
           plot_title="Trendline example")

binned_multiSeries$group1 <- 2
binned_multiSeries$group2 <- rep(3, 461)

```




```{r test data}
require(IdeoViz)
require(RColorBrewer)
data(binned_multiSeries)
ideo <- getIdeo("hg18")
head(ideo)
#Creating a GRanges object with sample IRanges object as range, a character vector for strand information, and another chracter vector for the sequence name 

seqnames = rep("chrY", 10000) #character vector 
strand = rep("+", 10000) #positive strands
ranges = IRanges(start = 1:10000, width = 500) #creating IRange sequences with 10,000 entries

#now creating GRanges object called test with the created seqnames, strand, and ranges parameters as before

test = GRanges(seqnames = seqnames, ranges = ranges, strand = strand)
#create a column called group with constant values to plot
test$group = 2

#now plot
plotOnIdeo(chrom=seqlevels(test), # which chrom to plot?
           ideoTable=ideo, # ideogram name
           values_GR=binned_multiSeries, # data goes here
           value_cols=1, # col to plot
           col=brewer.pal(n=5, 'Spectral'), # colours
           plotType = 'rect', # set y-axis range
           ylab="array intensities",
           plot_title="test example")
```


```{r}
testdata <- read.table("data/hg38_igv_manual_by_side.bed", col.names = c("Chromosome_and_strand", "start", "end"), stringsAsFactors = FALSE) #reading in our data
testdata$Chromosome_and_strand
testdata[, 1]
testdata = separate(testdata, 1, into = c("chromosome", "strand"), sep="_", remove = TRUE) #using tidyverse's function "separate" to separate the chromosome name and strand data
testdata$strand <- sub("r", "-", testdata$strand) #replacing the r with "-"s for use as strand data
testdata
testdata$strand <- sub("f", "+", testdata$strand)
testdata


```

